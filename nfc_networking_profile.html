<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>NFC Profile</title>
<style>
  :root{
    --bg1:#7f1d1d; /* red-800 */
    --bg2:#ea580c; /* orange-600 */
    --bg3:#f59e0b; /* yellow-500 */
    --white:255,255,255;
  }
  html,body{height:100%}
  body{
    margin:0;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell,
                 Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji","Segoe UI Emoji";
    background: radial-gradient(1200px 800px at 20% 10%, rgba(var(--white),0.08), transparent 60%),
                radial-gradient(800px 800px at 80% 80%, rgba(255,204,0,0.12), transparent 60%),
                linear-gradient(135deg, var(--bg1), var(--bg2) 45%, var(--bg3));
    display:flex; align-items:center; justify-content:center; padding:16px;
    color:#fff;
  }
  .orb{position:fixed; border-radius:999px; filter:blur(40px); opacity:.8; pointer-events:none}
  .orb.o1{top:20%; left:20%; width:260px; height:260px; background:rgba(255,255,255,.12); animation:blob 7s infinite}
  .orb.o2{bottom:20%; right:20%; width:200px; height:200px; background:rgba(255,215,0,.18); animation:blob 7s infinite 2s}
  .orb.o3{top:75%; left:50%; width:140px; height:140px; background:rgba(239,68,68,.18); animation:blob 7s infinite 4s}
  @keyframes blob{
    0%{transform:translate(0,0) scale(1)}
    33%{transform:translate(30px,-40px) scale(1.06)}
    66%{transform:translate(-20px,20px) scale(.94)}
    100%{transform:translate(0,0) scale(1)}
  }
  .wrap{position:relative; width:100%; max-width:780px}
  .card{
    backdrop-filter: blur(20px);
    background: rgba(var(--white),0.10);
    border: 1px solid rgba(var(--white),0.35);
    border-radius: 24px;
    box-shadow: 0 20px 60px rgba(0,0,0,.35);
  }
  .pad{padding:24px}
  .title{font-weight:800; font-size:24px; letter-spacing:.2px}
  .subtle{color:rgba(var(--white),0.8)}
  .row{display:flex; gap:16px}
  .col{flex:1}
  .input, .textarea, .select, .readonly{
    width:100%;
    padding:12px 14px;
    border-radius:14px;
    border:1px solid rgba(var(--white),0.4);
    background: rgba(255,255,255,0.18);
    color:#fff; outline:none;
  }
  .input::placeholder,.textarea::placeholder{color:rgba(255,255,255,.6)}
  .textarea{min-height:110px; resize:vertical}
  label{display:block; margin:12px 0 6px; font-weight:600}
  .btn{
    display:inline-flex; align-items:center; justify-content:center; gap:10px;
    padding:12px 20px; border:0; border-radius:14px; cursor:pointer;
    font-weight:700; color:#fff;
    background: linear-gradient(90deg, #7c3aed, #db2777);
    transition: transform .06s ease, filter .2s ease;
  }
  .btn:disabled{opacity:.6; cursor:not-allowed}
  .btn:hover{filter:brightness(1.03)}
  .btn:active{transform:translateY(1px)}
  .btn-outline{
    background: rgba(255,255,255,.18);
    border:1px solid rgba(255,255,255,.45);
  }
  .footer-actions{display:flex; gap:12px; justify-content:flex-end; margin-top:18px}
  .copywrap{position:relative}
  .copybtn{
    position:absolute; right:6px; top:50%; transform:translateY(-50%);
    background:transparent; border:0; color:#fff; cursor:pointer; padding:6px;
  }
  .badge{
    display:inline-block; padding:6px 10px; border-radius:999px; font-weight:600;
    background: rgba(255,255,255,.18); border:1px solid rgba(255,255,255,.4);
    margin-bottom:16px;
  }
  .center{text-align:center}
  .hidden{display:none}
  .avatar{
    width:128px; height:128px; border-radius:999px; overflow:hidden; margin:0 auto 16px;
    background:linear-gradient(135deg,#a78bfa,#f472b6);
    border:1px solid rgba(255,255,255,.45); padding:4px;
  }
  .avatar>img{width:100%; height:100%; object-fit:cover; border-radius:999px}
  .section{padding:0 24px 24px}
  .pill{display:inline-flex; align-items:center; gap:8px; margin:0 auto 12px; opacity:.9}
  .kicker{font-size:14px; color:rgba(255,255,255,.85)}
  .muted{color:rgba(255,255,255,.75)}
  .warn{color:#fde68a}
  .ok{color:#86efac}
  .error{color:#fecaca}
  .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;}
</style>
</head>
<body>
  <!-- floating glow orbs -->
  <div class="orb o1"></div>
  <div class="orb o2"></div>
  <div class="orb o3"></div>

  <div class="wrap">
    <!-- VIEW MODE (shown when URL contains #d=...) -->
    <div id="viewCard" class="card pad hidden">
      <div class="center">
        <div class="avatar" id="v_avatar"></div>
        <h1 id="v_name" class="title" style="margin:6px 0 8px"></h1>
        <div id="v_school" class="kicker"></div>
        <div id="v_grade" class="badge hidden"></div>
      </div>
      <div class="section">
        <div id="v_interests_wrap" class="card pad" style="background:rgba(255,255,255,.10); margin-top:16px;">
          <div class="pill"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg><strong>Interests</strong></div>
          <div id="v_interests" class="muted"></div>
        </div>
        <div class="card pad" style="background:rgba(255,255,255,.10); margin-top:16px;">
          <div style="display:flex; flex-direction:column; gap:10px">
            <a id="v_linkedin" class="btn" target="_blank" rel="noopener"> 
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M7 7h3v10H7zM8.5 4.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3zM14 7h3v1.5a3 3 0 0 1 3-3h.5V7H20a2 2 0 0 0-2 2v8h-4z"/></svg>
              Connect on LinkedIn
            </a>
            <a id="v_phone" class="btn btn-outline" href="#">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M22 16.92v3a2 2 0 0 1-2.18 2A19.79 19.79 0 0 1 3.1 5.18 2 2 0 0 1 5.11 3h3a2 2 0 0 1 2 1.72c.12.9.3 1.77.57 2.6a2 2 0 0 1-.45 2.11L9.1 10.91a16 16 0 0 0 4 4l1.47-1.13a2 2 0 0 1 2.11-.45c.83.27 1.7.45 2.6.57A2 2 0 0 1 22 16.92z"/></svg>
              <span id="v_phone_txt"></span>
            </a>
            <a id="v_email" class="btn btn-outline" href="#">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M4 4h16v16H4z"/><path d="m22 6-10 7L2 6"/></svg>
              <span id="v_email_txt"></span>
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- CREATE MODE (shown when there is no #d=...) -->
    <div id="createCard" class="card pad hidden">
      <div style="margin-bottom:8px">
        <div class="title">Create Your Profile</div>
        <div class="subtle" style="margin-top:6px">Fill out your details to generate a shareable, NFC-friendly URL.</div>
      </div>

      <div class="row">
        <div class="col">
          <label>Full Name *</label>
          <input id="i_name" class="input" placeholder="Jane Doe" />
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label>University</label>
          <input id="i_univ" class="input" placeholder="Your university" />
        </div>
        <div class="col">
          <label>Major</label>
          <input id="i_major" class="input" placeholder="Your major/field" />
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label>Grade Level</label>
          <select id="i_grade" class="input select">
            <option value="">Select your grade level</option>
            <option>Freshman</option><option>Sophomore</option><option>Junior</option>
            <option>Senior</option><option>Graduate</option><option>PhD</option>
          </select>
        </div>
        <div class="col">
          <label>Phone Number</label>
          <input id="i_phone" class="input" placeholder="+1 555 123 4567" />
        </div>
      </div>

      <div>
        <label>Email</label>
        <input id="i_email" class="input" placeholder="you@example.com" />
      </div>

      <div>
        <label>LinkedIn URL</label>
        <input id="i_linkedin" class="input" placeholder="https://linkedin.com/in/yourhandle" />
      </div>

      <div>
        <label>Interests</label>
        <textarea id="i_interests" class="textarea" placeholder="Tell others about your interests and hobbies..."></textarea>
      </div>

      <div class="footer-actions">
        <button id="btnGen" class="btn"><span>Generate URL</span></button>
      </div>

      <div id="result" class="card pad hidden" style="margin-top:14px; background:rgba(0,0,0,.25)">
        <div class="kicker">Copy this URL and write it to your NFC tag.</div>
        <div class="copywrap" style="margin-top:10px">
          <input id="outUrl" class="readonly mono input" readonly />
          <button id="btnCopy" class="copybtn" title="Copy">üìã</button>
        </div>
        <div id="lenNote" class="mono" style="margin-top:8px; font-size:13px">
          Length: <span id="lenVal">0</span> / <strong>492</strong>
          <span id="lenWarn" class="warn hidden"> ‚Ä¢ Over limit‚Äîshorten some fields (often ‚ÄúInterests‚Äù or LinkedIn).</span>
          <span id="lenOk" class="ok hidden"> ‚Ä¢ Good to go ‚úÖ</span>
        </div>
        <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap">
          <a id="btnPreview" class="btn btn-outline" target="_blank" rel="noopener">Preview</a>
          <button id="btnReset" class="btn btn-outline" type="button">Create Another</button>
        </div>
      </div>
    </div>
  </div>

<script>
/* ===== Minimal LZ-String (compressToEncodedURIComponent / decompressFromEncodedURIComponent) =====
   Source: https://github.com/pieroxy/lz-string (MIT). Trimmed to only needed methods. */
var LZString=function(){function o(o,r){if(!t[o]){t[o]={};for(var n=0;n<o.length;n++)t[o][o.charAt(n)]=n}return t[o][r]}var r=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",t={},e={compressToEncodedURIComponent:function(o){return null==o?"":e._compress(o,6,function(o){return n.charAt(o)})},decompressFromEncodedURIComponent:function(r){return null==r?"":""==r?null:(r=r.replace(/ /g,"+"),e._decompress(r.length,32,function(t){return o(n,r.charAt(t))}))},_compress:function(o,n,t){if(null==o)return"";var e,i,u,a={},c={},s="",p="",f="",l=2,h=3,d=2,v=[],g=0,m=0;for(i=0;i<o.length;i+=1)if(s=o.charAt(i),Object.prototype.hasOwnProperty.call(a,s)||(a[s]=h++,c[s]=!0),p=f+s,Object.prototype.hasOwnProperty.call(a,p))f=p;else{if(Object.prototype.hasOwnProperty.call(c,f)){if(f.charCodeAt(0)<256){for(e=0;e<d;e++)g<<=1,m==n-1?(m=0,v.push(t(g)),g=0):m++;for(u=f.charCodeAt(0),e=0;e<8;e++)g=g<<1|1&u,m==n-1?(m=0,v.push(t(g)),g=0):m++,u>>=1}else{for(u=1,e=0;e<d;e++)g=g<<1|u,m==n-1?(m=0,v.push(t(g)),g=0):m++,u=0;for(u=f.charCodeAt(0),e=0;e<16;e++)g=g<<1|1&u,m==n-1?(m=0,v.push(t(g)),g=0):m++,u>>=1}l--,0==l&&(l=Math.pow(2,d),d++),delete c[f]}else for(u=a[f],e=0;e<d;e++)g=g<<1|1&u,m==n-1?(m=0,v.push(t(g)),g=0):m++,u>>=1;l--,0==l&&(l=Math.pow(2,d),d++),a[p]=h++,f=String(s)}if(""!==f){if(Object.prototype.hasOwnProperty.call(c,f)){if(f.charCodeAt(0)<256){for(e=0;e<d;e++)g<<=1,m==n-1?(m=0,v.push(t(g)),g=0):m++;for(u=f.charCodeAt(0),e=0;e<8;e++)g=g<<1|1&u,m==n-1?(m=0,v.push(t(g)),g=0):m++,u>>=1}else{for(u=1,e=0;e<d;e++)g=g<<1|u,m==n-1?(m=0,v.push(t(g)),g=0):m++,u=0;for(u=f.charCodeAt(0),e=0;e<16;e++)g=g<<1|1&u,m==n-1?(m=0,v.push(t(g)),g=0):m++,u>>=1}l--,0==l&&(l=Math.pow(2,d),d++),delete c[f]}else for(u=a[f],e=0;e<d;e++)g=g<<1|1&u,m==n-1?(m=0,v.push(t(g)),g=0):m++,u>>=1;l--,0==l&&(l=Math.pow(2,d),d++)}for(u=2,e=0;e<d;e++)g=g<<1|1&u,m==n-1?(m=0,v.push(t(g)),g=0):m++,u>>=1;for(;;){if(g<<=1,m==n-1){v.push(t(g));break}m++}return v.join("")},_decompress:function(o,n,t){var e,i,u,a,c,s,p,f,l,h=[],d=4,v=4,g=3,m="",w=[],A={val:t(0),position:n,index:1};for(i=0;i<3;i+=1)h[i]=i;for(u=0,c=Math.pow(2,2),s=1;s!=c;)a=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=t(A.index++)),u|=(a>0?1:0)*s,s<<=1;switch(u){case 0:for(u=0,c=Math.pow(2,8),s=1;s!=c;)a=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=t(A.index++)),u|=(a>0?1:0)*s,s<<=1;f=r(u);break;case 1:for(u=0,c=Math.pow(2,16),s=1;s!=c;)a=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=t(A.index++)),u|=(a>0?1:0)*s,s<<=1;f=r(u);break;case 2:return""}for(h[3]=f,p=f,w.push(f);;){if(A.index>o)return"";for(u=0,c=Math.pow(2,g),s=1;s!=c;)a=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=t(A.index++)),u|=(a>0?1:0)*s,s<<=1;switch(i=u){case 0:for(u=0,c=Math.pow(2,8),s=1;s!=c;)a=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=t(A.index++)),u|=(a>0?1:0)*s,s<<=1;h[v++]=r(u),i=v-1,g--;break;case 1:for(u=0,c=Math.pow(2,16),s=1;s!=c;)a=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=t(A.index++)),u|=(a>0?1:0)*s,s<<=1;h[v++]=r(u),i=v-1,g--;break;case 2:return w.join("")}if(0==g&&(g=Math.pow(2,++m.length),d++,v==d&&(d=Math.pow(2,g))),h[i])f=h[i];else{if(i!==v)return null;f=p+p.charAt(0)}w.push(f),h[v++]=p+f.charAt(0),p=f,0==--d&&(d=Math.pow(2,g),g++)}}
}; return e}();

/* ===== Helpers ===== */
const $ = sel => document.querySelector(sel);
const byId = id => document.getElementById(id);

function compactPayload(){
  // Use short keys to minimize size
  const obj = {
    n: byId('i_name').value.trim(),
    u: byId('i_univ').value.trim(),
    m: byId('i_major').value.trim(),
    g: byId('i_grade').value,
    i: byId('i_interests').value.trim(),
    l: normalizeLinkedIn(byId('i_linkedin').value.trim()),
    p: normalizePhone(byId('i_phone').value.trim()),
    e: byId('i_email').value.trim()
  };
  // Required name
  if(!obj.n){ alert('Full Name is required.'); return null; }
  return obj;
}

function normalizeLinkedIn(url){
  if(!url) return "";
  url = url.replace(/^http(s)?:\/\//i,''); // drop protocol
  url = url.replace(/^www\./i,'');
  // keep only linkedin host + path
  const m = url.match(/^([a-z]+\.)?linkedin\.com\/(.*)$/i);
  return m ? ('linkedin.com/' + m[2].replace(/\/+$/,'')) : url;
}
function normalizePhone(ph){
  if(!ph) return "";
  // strip spaces, parentheses, dashes
  const digits = ph.replace(/[^\d+]/g,'');
  return digits;
}

function makeUrl(obj){
  const json = JSON.stringify(obj);
  const token = LZString.compressToEncodedURIComponent(json);
  const base = location.origin + location.pathname; // same file
  return `${base}#d=${token}`;
}

function parseHash(){
  const h = location.hash || "";
  const m = h.match(/[#&]d=([^&]+)/);
  if(!m) return null;
  try{
    const json = LZString.decompressFromEncodedURIComponent(m[1]);
    if(!json) return null;
    const data = JSON.parse(json);
    return data;
  }catch(e){ return null; }
}

function toggle(el, show){ el.classList[show ? 'remove' : 'add']('hidden'); }

function setLenStatus(url){
  const len = url.length;
  byId('lenVal').textContent = len;
  const over = len > 492;
  toggle(byId('lenWarn'), over ? true : false);
  toggle(byId('lenOk'), over ? false : true);
  return !over;
}

function resetForm(){
  ['i_name','i_univ','i_major','i_grade','i_interests','i_linkedin','i_phone','i_email'].forEach(id=>{
    const el=byId(id); if(el){ if(el.tagName==='SELECT') el.value=""; else el.value=""; }
  });
  toggle(byId('result'), false);
}

function renderView(data){
  // Avatar
  const av = byId('v_avatar');
  av.innerHTML = "";
  const initials = (data.n||"?").slice(0,1).toUpperCase();
  const img = null; // No image in this spec to keep URL tiny (NFC constraint)
  if(img){
    const im = document.createElement('img'); im.src = img; av.appendChild(im);
  }else{
    const ph = document.createElement('div');
    ph.style.width="100%"; ph.style.height="100%"; ph.style.borderRadius="999px";
    ph.style.display="flex"; ph.style.alignItems="center"; ph.style.justifyContent="center";
    ph.style.background="linear-gradient(135deg,#a78bfa,#f472b6)";
    ph.innerHTML = `<span style="font-size:48px;font-weight:800;color:white">${initials}</span>`;
    av.appendChild(ph);
  }

  byId('v_name').textContent = data.n || '‚Äî';
  const school = [data.m, data.u].filter(Boolean).join(' ‚Ä¢ ');
  byId('v_school').textContent = school;
  const grade = byId('v_grade');
  if(data.g){ grade.textContent = data.g; grade.classList.remove('hidden'); } else { grade.classList.add('hidden'); }

  if(data.i){
    byId('v_interests').textContent = data.i;
    byId('v_interests_wrap').style.display = "";
  } else {
    byId('v_interests_wrap').style.display = "none";
  }

  const linkA = byId('v_linkedin');
  if(data.l){
    linkA.href = 'https://' + (data.l.startsWith('linkedin.com') ? data.l : data.l);
    linkA.style.display = "inline-flex";
  } else {
    linkA.style.display = "none";
  }

  const phA = byId('v_phone');
  if(data.p){
    phA.href = 'tel:' + data.p;
    byId('v_phone_txt').textContent = data.p;
    phA.style.display = "inline-flex";
  } else {
    phA.style.display = "none";
  }

  const emA = byId('v_email');
  if(data.e){
    emA.href = 'mailto:' + data.e;
    byId('v_email_txt').textContent = data.e;
    emA.style.display = "inline-flex";
  } else {
    emA.style.display = "none";
  }
}

function init(){
  const data = parseHash();
  if(data){
    // VIEW ONLY
    toggle(byId('viewCard'), true);
    toggle(byId('createCard'), false);
    renderView(data);
    return;
  }
  // CREATE
  toggle(byId('viewCard'), false);
  toggle(byId('createCard'), true);

  byId('btnGen').addEventListener('click', ()=>{
    const obj = compactPayload();
    if(!obj) return;
    const url = makeUrl(obj);
    byId('outUrl').value = url;
    toggle(byId('result'), true);
    const ok = setLenStatus(url);
    if(!ok){
      // try a micro-optimization: trim whitespace & collapse spaces in interests
      obj.i = (obj.i||"").replace(/\s+/g,' ').trim();
      const url2 = makeUrl(obj);
      if(url2.length < url.length){
        byId('outUrl').value = url2;
        setLenStatus(url2);
      }
    }
    byId('btnPreview').href = byId('outUrl').value;
  });

  byId('btnCopy').addEventListener('click', async ()=>{
    const v = byId('outUrl').value;
    try{ await navigator.clipboard.writeText(v);
      byId('btnCopy').textContent = '‚úÖ';
      setTimeout(()=>byId('btnCopy').textContent='üìã', 1600);
    }catch{ alert('Copy failed. Select the text and copy manually.'); }
  });

  byId('btnReset').addEventListener('click', resetForm);
}

window.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>

